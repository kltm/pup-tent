////
//// Some quick and dirty unit testing.
////

var assert = require('assert');

// Trivial tests for explicit file mentions in the constructor.
(function(){

    var pup_tent = require('pup-tent')(['tests/rsrc1', 'tests/rsrc2'],
				       ['trivial.tmpl']);
				   
    assert.ok(pup_tent, 'constructor okay');

    //console.log(assert.equal(pup_tent.cached_list()));
    assert.equal(pup_tent.cached_list().length, 2, 'two items (a)');
    assert.equal(pup_tent.cached_list('all').length, 2, 'two items (b)');
    assert.equal(pup_tent.cached_list('flat').length, 1, 'one item (a)');
    assert.equal(pup_tent.cached_list('full').length, 1, 'one item (b)');

    assert.equal(pup_tent.get('foo'), null, 'nothing for foo');
    assert.equal(pup_tent.get('trivial.tmpl'), 'name: {{ name }}',
		 'tmpl string');
    
    assert.equal(pup_tent.apply('trivial.tmpl', {name: 1}),
		 'name: 1', 'name: 1');
    
})();

// Trivial tests for file searching in the constructor.
(function(){

    var pup_tent = require('pup-tent')(['tests/rsrc1', 'tests/rsrc2']);
				   
    assert.ok(pup_tent, 'constructor okay');

    assert.equal(pup_tent.cached_list().length, 2, 'two items (a)');
    assert.equal(pup_tent.cached_list('all').length, 2, 'two items (b)');
    assert.equal(pup_tent.cached_list('flat').length, 1, 'one item (a)');
    assert.equal(pup_tent.cached_list('full').length, 1, 'one item (b)');

    assert.equal(pup_tent.get('foo'), null, 'nothing for foo');
    assert.equal(pup_tent.get('trivial.tmpl'), 'name: {{ name }}',
		 'tmpl string');
    
    assert.equal(pup_tent.apply('trivial.tmpl', {name: 1}),
		 'name: 1', 'name: 1');
    
})();
